#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\"\"\"\nå®Œæ•´æ•°æ®è¡¨æ ¼ç¾åŒ–æ˜¾ç¤º\nå±•ç¤ºæ‰€æœ‰49ä¸ªå®éªŒç»„çš„è¯¦ç»†æ•°æ®\n\"\"\"\n\nimport pandas as pd\nimport numpy as np\n\ndef display_complete_table():\n    \"\"\"æ˜¾ç¤ºå®Œæ•´çš„æ•°æ®è¡¨æ ¼\"\"\"\n    \n    # è¯»å–ç”Ÿæˆçš„CSVæ–‡ä»¶\n    df = pd.read_csv('ç”°å£å®éªŒå®Œæ•´æ•°æ®è¡¨_20250624_222654.csv')\n    \n    print(\"ğŸ“Š ç”°å£å®éªŒå®Œæ•´æ•°æ®è¡¨æ ¼ï¼ˆ49ç»„ï¼‰\")\n    print(\"=\" * 120)\n    print(f\"å®éªŒæ—¶é—´: 2025-06-24 22:26:54\")\n    print(f\"å®éªŒè§„æ¨¡: {len(df)} ç»„ Ã— 10 æ¬¡é‡å¤ = {len(df) * 10} æ¬¡å®éªŒ\")\n    print(\"\\nã€è¡¨æ ¼è¯´æ˜ã€‘\")\n    print(\"- æ’å: æŒ‰SNRå€¼ä»é«˜åˆ°ä½æ’åº (SNRè¶Šé«˜è¶Šå¥½)\")\n    print(\"- åŠ æƒå¾—åˆ†: 5:3:2æƒé‡çš„ç»¼åˆè¯„ä»·æŒ‡æ ‡ (è¶…ä½“ç§¯:åå‘ä¸–ä»£è·ç¦»:ä¸–ä»£è·ç¦»)\")\n    print(\"- SNRå€¼: ç”°å£æ–¹æ³•ä¿¡å™ªæ¯”ï¼Œè¶Šé«˜è¡¨ç¤ºæ€§èƒ½è¶Šç¨³å®š\")\n    print(\"\\n\" + \"=\" * 120)\n    \n    # åˆ›å»ºç®€åŒ–æ˜¾ç¤ºçš„è¡¨æ ¼\n    display_df = df.copy()\n    \n    # æ ¼å¼åŒ–æ•°å€¼æ˜¾ç¤º\n    display_df['A_å­¦ä¹ ç‡å€¼'] = display_df['A_å­¦ä¹ ç‡å€¼'].apply(lambda x: f\"{x:.6f}\")\n    display_df['B_æ¢ç´¢ç‡è¡°å‡å€¼'] = display_df['B_æ¢ç´¢ç‡è¡°å‡å€¼'].apply(lambda x: f\"{x:.4f}\")\n    display_df['D_æŠ˜æ‰£å› å­å€¼'] = display_df['D_æŠ˜æ‰£å› å­å€¼'].apply(lambda x: f\"{x:.3f}\")\n    display_df['åŠ æƒå¾—åˆ†'] = display_df['åŠ æƒå¾—åˆ†'].apply(lambda x: f\"{x:.6f}\")\n    display_df['SNRå€¼'] = display_df['SNRå€¼'].apply(lambda x: f\"{x:.3f}\")\n    \n    # ç®€åŒ–é¹°ç¾¤åˆ†ç»„é…ç½®æ˜¾ç¤º\n    group_mapping = {\n        \"è¶…çº§æ¢ç´¢ä¸»å¯¼ [0.70,0.15,0.10,0.05]\": \"è¶…çº§æ¢ç´¢ä¸»å¯¼\",\n        \"æç«¯æ¢ç´¢ä¸»å¯¼ [0.60,0.20,0.15,0.05]\": \"æç«¯æ¢ç´¢ä¸»å¯¼\", \n        \"æ¢ç´¢ä¸»å¯¼ [0.50,0.30,0.15,0.05]\": \"æ¢ç´¢ä¸»å¯¼\",\n        \"åŸºå‡†å¹³è¡¡ [0.45,0.25,0.20,0.10]\": \"åŸºå‡†å¹³è¡¡\",\n        \"å¼€å‘ä¸»å¯¼ [0.35,0.40,0.20,0.05]\": \"å¼€å‘ä¸»å¯¼\",\n        \"æç«¯å¼€å‘ä¸»å¯¼ [0.25,0.45,0.20,0.10]\": \"æç«¯å¼€å‘ä¸»å¯¼\",\n        \"è¶…çº§å¼€å‘ä¸»å¯¼ [0.20,0.50,0.20,0.10]\": \"è¶…çº§å¼€å‘ä¸»å¯¼\"\n    }\n    \n    display_df['C_é¹°ç¾¤åˆ†ç»„é…ç½®'] = display_df['C_é¹°ç¾¤åˆ†ç»„é…ç½®'].map(group_mapping)\n    \n    # é€‰æ‹©å…³é”®åˆ—æ˜¾ç¤º\n    key_columns = ['å®éªŒç»„', 'æ’å', 'A_å­¦ä¹ ç‡å€¼', 'B_æ¢ç´¢ç‡è¡°å‡å€¼', \n                   'C_é¹°ç¾¤åˆ†ç»„é…ç½®', 'D_æŠ˜æ‰£å› å­å€¼', 'åŠ æƒå¾—åˆ†', 'SNRå€¼']\n    \n    final_df = display_df[key_columns]\n    \n    # é‡å‘½ååˆ—ä»¥ä¾¿æ›´å¥½æ˜¾ç¤º\n    final_df.columns = ['ç»„åˆ«', 'æ’å', 'å­¦ä¹ ç‡', 'æ¢ç´¢ç‡è¡°å‡', 'é¹°ç¾¤åˆ†ç»„', 'æŠ˜æ‰£å› å­', 'åŠ æƒå¾—åˆ†', 'SNR(dB)']\n    \n    # åˆ†æ‰¹æ˜¾ç¤ºï¼ˆæ¯15è¡Œä¸€æ‰¹ï¼‰\n    batch_size = 15\n    total_batches = len(final_df) // batch_size + (1 if len(final_df) % batch_size > 0 else 0)\n    \n    for batch in range(total_batches):\n        start_idx = batch * batch_size\n        end_idx = min((batch + 1) * batch_size, len(final_df))\n        \n        print(f\"\\nğŸ“‹ ç¬¬ {batch + 1} æ‰¹å®éªŒç»„ (ç¬¬ {start_idx + 1}-{end_idx} ç»„)\")\n        print(\"-\" * 120)\n        \n        batch_df = final_df.iloc[start_idx:end_idx].copy()\n        \n        # è®¾ç½®pandasæ˜¾ç¤ºé€‰é¡¹\n        pd.set_option('display.max_columns', None)\n        pd.set_option('display.width', None)\n        pd.set_option('display.max_colwidth', 15)\n        \n        print(batch_df.to_string(index=False))\n        print()\n    \n    # æ˜¾ç¤ºç»Ÿè®¡æ±‡æ€»\n    print(\"\\nğŸ“ˆ ç»Ÿè®¡æ±‡æ€»\")\n    print(\"=\" * 60)\n    print(f\"ğŸ¥‡ æœ€ä¼˜å®éªŒç»„: ç¬¬{df.iloc[0]['å®éªŒç»„']}ç»„\")\n    print(f\"   - å­¦ä¹ ç‡: {df.iloc[0]['A_å­¦ä¹ ç‡å€¼']:.6f}\")\n    print(f\"   - æ¢ç´¢ç‡è¡°å‡: {df.iloc[0]['B_æ¢ç´¢ç‡è¡°å‡å€¼']:.4f}\")\n    print(f\"   - é¹°ç¾¤åˆ†ç»„: {group_mapping[df.iloc[0]['C_é¹°ç¾¤åˆ†ç»„é…ç½®']]}\")\n    print(f\"   - æŠ˜æ‰£å› å­: {df.iloc[0]['D_æŠ˜æ‰£å› å­å€¼']:.3f}\")\n    print(f\"   - åŠ æƒå¾—åˆ†: {df.iloc[0]['åŠ æƒå¾—åˆ†']:.6f}\")\n    print(f\"   - SNRå€¼: {df.iloc[0]['SNRå€¼']:.3f} dB\")\n    \n    print(f\"\\nğŸ¥ˆ ç¬¬äºŒåå®éªŒç»„: ç¬¬{df.iloc[1]['å®éªŒç»„']}ç»„ (SNR: {df.iloc[1]['SNRå€¼']:.3f} dB)\")\n    print(f\"ğŸ¥‰ ç¬¬ä¸‰åå®éªŒç»„: ç¬¬{df.iloc[2]['å®éªŒç»„']}ç»„ (SNR: {df.iloc[2]['SNRå€¼']:.3f} dB)\")\n    \n    print(f\"\\nğŸ“Š æ€§èƒ½ç»Ÿè®¡:\")\n    print(f\"   - æœ€é«˜SNR: {df['SNRå€¼'].max():.3f} dB\")\n    print(f\"   - æœ€ä½SNR: {df['SNRå€¼'].min():.3f} dB\")\n    print(f\"   - å¹³å‡SNR: {df['SNRå€¼'].mean():.3f} Â± {df['SNRå€¼'].std():.3f} dB\")\n    print(f\"   - æ€§èƒ½è·¨åº¦: {df['SNRå€¼'].max() - df['SNRå€¼'].min():.3f} dB\")\n    \n    print(f\"\\n   - æœ€é«˜åŠ æƒå¾—åˆ†: {df['åŠ æƒå¾—åˆ†'].max():.6f}\")\n    print(f\"   - æœ€ä½åŠ æƒå¾—åˆ†: {df['åŠ æƒå¾—åˆ†'].min():.6f}\")\n    print(f\"   - å¹³å‡åŠ æƒå¾—åˆ†: {df['åŠ æƒå¾—åˆ†'].mean():.6f} Â± {df['åŠ æƒå¾—åˆ†'].std():.6f}\")\n    \n    # å› å­åˆ†æ\n    print(f\"\\nğŸ¯ å› å­é‡è¦æ€§åˆ†æ:\")\n    factors = ['A_å­¦ä¹ ç‡æ°´å¹³', 'B_æ¢ç´¢ç‡è¡°å‡æ°´å¹³', 'C_é¹°ç¾¤åˆ†ç»„æ°´å¹³', 'D_æŠ˜æ‰£å› å­æ°´å¹³']\n    factor_names = ['å­¦ä¹ ç‡', 'æ¢ç´¢ç‡è¡°å‡', 'é¹°ç¾¤åˆ†ç»„', 'æŠ˜æ‰£å› å­']\n    \n    factor_effects = {}\n    for factor, name in zip(factors, factor_names):\n        level_means = df.groupby(factor)['SNRå€¼'].mean()\n        effect_range = level_means.max() - level_means.min()\n        factor_effects[name] = effect_range\n    \n    sorted_effects = sorted(factor_effects.items(), key=lambda x: x[1], reverse=True)\n    for i, (factor, effect) in enumerate(sorted_effects, 1):\n        print(f\"   {i}. {factor}: {effect:.3f} dB\")\n    \n    print(\"\\nâœ… å®Œæ•´æ•°æ®è¡¨æ ¼æ˜¾ç¤ºå®Œæˆï¼\")\n    print(f\"ğŸ’¾ è¯¦ç»†æ•°æ®å·²ä¿å­˜åˆ°: ç”°å£å®éªŒå®Œæ•´æ•°æ®è¡¨_20250624_222654.xlsx\")\n    print(f\"ğŸ’¾ CSVæ ¼å¼: ç”°å£å®éªŒå®Œæ•´æ•°æ®è¡¨_20250624_222654.csv\")\n\nif __name__ == \"__main__\":\n    display_complete_table() 