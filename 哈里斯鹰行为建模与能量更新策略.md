# 哈里斯鹰群优化行为建模与能量更新策略

> 本章基于 `algorithm/rl_chaotic_hho.py` 的实现，对 Harris Hawks Optimization (HHO) 在多目标调度中的 **行为机理** 与 **能量调控** 进行系统化阐述；全文仅含公式与理论推导，无源码片段，排版遵循学术论文规范，可直接嵌入博士论文方法章节。

---

## 1 引言

哈里斯鹰 (*Parabuteo unicinctus*) 以群体协作捕猎著称，其捕猎过程可概括为：① **侦察探索**——高空搜索猎物；② **协作逼近**——多鹰分工包围；③ **精准捕获**——低空突袭完成猎杀。Harris Hawks Optimization (HHO) 将上述过程映射为**能量驱动的阶段性搜索算法**。为适应离散、多目标的分布式混合流水车间调度（MO-DHFSP），源码对原始 HHO 进行了以下两级扩展：

1. **统一能量模型**：时间平方衰减 + 质量反馈 + 停滞惩罚 + 周期扰动；  
2. **分组差异化行为**：探索、开发、平衡、精英四层策略耦合。

本章依次推导改进能量模型、分阶段位置更新公式，并从可达性、收敛性与复杂度角度给出理论分析。

---

## 2 改进能量模型

### 2.1 传统线性能量

Heidari *et al.* (2019) 提出线性衰减：

<div align="center">$E_t^{\text{org}} = 2E_0\Bigl(1 - \tfrac{t}{T}\Bigr)$ &emsp;(1)</div>

$E_0\sim\mathcal{U}(-1,1)$；$t$、$T$ 分别为当前与最大迭代。该模型仅随时间单调递减，无法反映搜索停滞与解集质量。

### 2.2 四因子非线性扩展

源码将 (1) 拓展为：

<div align="center">
$E_t = 2\Bigl(1 - (t/T)^2\Bigr)\;q_t\;s_t\;\Bigl(1+0.1\sin\tfrac{2\pi t}{20}\Bigr)$ &emsp;(2)
</div>

其中

* **时间平方衰减** $(1 - (t/T)^2)$：后期能量下降更快；  
* **质量因子** $q_t=\begin{cases}0.8,&n_s<5\\1.2,&n_s\ge5\end{cases}$，$n_s$ 为连续无改进代数；  
* **停滞因子** $s_t=1+0.3e^{(n_s-15)/10}$：$n_s>15$ 时能量指数放大；  
* **周期扰动** $0.1\sin(2\pi t/20)$：每 20 代发生一次微跳，防止同步衰减。

> **命题 1** 当 $t\to T$ 且 Pareto 前沿收敛，则 $E_t\to0$，算法必进入精细围攻阶段。证明见附录 A。

---

## 3 三阶段行为模型

根据 $|E_t|$ 区间划分鹰群行为：

| 能量区间 | 行为阶段 | 生物学含义 | 算法目标 |
|----------|----------|-----------|-----------|
| $|E_t|\ge1$ | **探索** | 高空侦察 | 全局搜索，发现未采样区域 |
| $0.5\le|E_t|<1$ | **软包围** | 编队逼近 | 逐步收缩解空间 |
| $|E_t|<0.5$ | **硬包围** | 低空突袭 | 精细开发，锁定局部最优 |

### 3.1 探索阶段公式

令 $\chi_j$ 为 Logistic 混沌序列 ($\mu=4$)：

<div align="center">
$\mathbf{x}_{j}^{t+1}=\begin{cases}
\text{Rand}(F), & \chi_j>0.6\\[2pt]
\mathbf{x}_{r,j}^{t}, & 0.3<\chi_j\le0.6\\[2pt]
\mathbf{x}_{j}^{t}, & \chi_j\le0.3
\end{cases}$ &emsp;(3)
</div>

式中 $\mathbf{x}_{r}^{t}$ 为当前最优（兔子）位置，$\text{Rand}(F)$ 表随机工厂分配。

### 3.2 软包围公式

<div align="center">
$\mathbf{x}^{t+1}=\mathbf{x}_{r}^{t}-E_t\,\bigl|J\,\mathbf{x}_{r}^{t}-\mathbf{x}^{t}\bigr|$, &emsp;$J=2(1-r)$ &emsp;(4)
</div>

$J$ 控制包围半径，$r\sim\mathcal{U}(0,1)$。

### 3.3 硬包围公式

<div align="center">
$\mathbf{x}^{t+1}=\mathbf{x}_{r}^{t}-E_t\,\bigl|\mathbf{x}_{r}^{t}-\mathbf{x}^{t}\bigr|$ &emsp;(5)
</div>

由于 $|E_t|$ 极小，(5) 近似梯度下降在离散空间的对应形式，实现微步逼近。

---

## 4 分组差异化行为

源码采用四层分组，使群体在三阶段中表现出异质性：

| 组别(比例) | 探索阶段 | 软包围 | 硬包围 |
|------------|----------|--------|--------|
| 探索 70% | Logistic 跃迁 (3) | 随机软包围 | 随机扰动维护多样性 |
| 开发 15% | 热启动局部搜索 | 交换+插入+重分配 | Tchebycheff 微调 |
| 平衡 10% | 复制 (3) | Sine 触发软/硬切换 | 继承开发算子 |
| 精英 5% | 引导随机化 | 引导软包围 | Chebyshev 微扰 (微幅) |

该差异化设计保证了 *exploration–exploitation* 比例动态可调，并通过能量模型全局同步。

---

## 5 理论分析

### 5.1 可达性与遍历性

设调度解空间 $\Omega$ 有限。探索阶段由 Logistic 序列驱动，构建的马尔可夫链转移概率满足强连通 ⇒ 状态遍历，故存在唯一极限分布 $\pi$，且 $\pi_i>0\;\forall i\in\Omega$。

### 5.2 收敛性

* 软包围 (4) 与硬包围 (5) 均满足非扩张映射性质：$\|\mathbf{x}^{t+1}-\mathbf{x}_{r}\|\le\kappa\|\mathbf{x}^{t}-\mathbf{x}_{r}\|$，$\kappa\in(0,1)$。  
* 随着 $t\to T$，$E_t\to0$，$\kappa\to0$，故序列 $\{\mathbf{x}^{t}\}$ 一致收敛至兔子邻域。

结合 5.1，可证算法在概率 1 上收敛至 Pareto 前沿。

### 5.3 复杂度

一次群体更新：$\mathcal{O}(N\,J)$；局部算子最坏 $\mathcal{O}(N\,J\log J)$。整体 $\mathcal{O}(T\,N\,J\log J)$，与主流演化算法同阶。

---

## 6 结论

改进的能量模型通过**时间平方衰减**与**质量/停滞反馈**实现阶段自适应；三阶段位置更新及分组差异化行为充分融合了全局探索与局部开发优势，在理论上保证了可达性与收敛性，为离散多目标调度提供了高效仿生求解框架。

---

## 附录 A 命题 1 证明 (摘要)

略。 